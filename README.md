# Course Helper

[TOC]

## 需求分析

为进一步深化教育改革，加快我校优质教学资源的共建共享，我校引进了清华大学教育技术研究所研发的支撑教与学的网络支撑环境的综合平台，建立了厦门大学课程中心，即[couse平台](http://course.xmu.edu.cn/)。

course平台已有十年的使用历史，由于缺少更新、维护，使用起来非常不方便。但是由于学校强制要求教师学生使用course平台，我们不得不在平台上查看、下载课件，上传作业等等。加上近年主流浏览器都已经停止对Flash的支持、course平台登录添加伪VPN验证等等问题，这个平台的变得愈发不方便。

由此，个人决定做一款PC端course助手，方便同学们使用course网站。



## 软件功能

### 1. 快捷登录

用户在保存账号密码到本地后，启动即可快速登录course网站。无需输入密码、拖动滑块验证码。

### 2. 全新界面

提取关键元素、重构页面。(UI好才是真滴好~)

### 3. 课件批量下载

进入某课程后，可以勾选需要下载的文件，批量下载

### 4. 作业查看

爬取课程的作业信息，显示DDL等信息

### 5. 作业提交

富文本编辑框，绕过Flash限制。



## 难点分析与解决

### 前后端通信 ⭐⭐⭐⭐⭐

通信方式的选择：最早打算使用RPC等通信，但是问题很多，最后还是决定主体使用本地HTTP通信(fastapi)

虽然HTTP通信速度上不如RPC通信，但是用于本地HTTP通信速度差异可以忽略不计。



本来不想使用其他通信方式的，但是碰到了技术上的难点。

为了双向通信，让后端能够主动向前端发送请求，不得不额外使用了WebSocket。

然后在使用WebSocket时又出现了新的问题，因为WS通信不像HTTP能有每个请求的回复，需要进一步处理。

最后通过添加消息id判断出每个消息所属的请求，并且使用`asyncio.Future`来等待消息回复，成功拿到回复。



### 验证码 ⭐⭐⭐⭐

1. vpn滑块验证码

   获取滑块验证码的图片，PIL解析滑块图片，post通过

2. 统一身份登录错误次数过多出现的图形验证码

   图形验证码一般不会出现，若出现可能是密码问题，跳转到网页手动登录

### 部分页面的元素不方便提取后重构 ⭐⭐

使用原始网页，但使用js修改页面内容

### 作业提交Flash问题 ⭐⭐⭐

Electron 使用 Pepper Flash 插件，从而启用Flash

### 配置文件 ⭐

仅有少量数据，无需数据库，使用YAML配置文件，方便数组等结构读写。配置文件用于前端。



## 技术栈

### python（后端）

开发快捷，且期末大作业要求。

### electron+vue3（前端）

开发快速，UI美观，虽然体积偏大，但具有浏览器性质，方便本项目的一些操作。



